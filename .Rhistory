DPs[,c("studlab","tst_PorF-value","tst_p=0, f=1")][DPs$Crossoverstudy==1,]
#remove crossover studies with paired t-test p-value not available
DPs <- DPs[DPs$studlab!=161,]
# use threshold value for those with p-value <0.001
DPs[DPs$studlab==185, "tst_PorF-value"] <- 0.00099
#now calculate adjusted SE for remaining crossover studies
DPs$tvalue <- qt(as.numeric(DPs$`tst_PorF-value`)/2, df=DPs$n1-1, lower.tail = F)
DPs$SDd <- abs((DPs$mean2-DPs$mean1)/DPs$tvalue*sqrt(DPs$n1))
DPs$rho <- (DPs$sd1^2 + DPs$sd2^2 - DPs$SDd^2)/(2*DPs$sd1*DPs$sd2)
DPs[DPs$Crossoverstudy==1,"seTE"] <- sqrt((1/DPs$n1 + DPs$TE/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1]
EFF<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs,  sm="SMD",r="pbo",comb.fixed =F, comb.random = T, tol.multiarm = 0.05, details.chkmultiarm = T)    ### gives error: Problems in multi-arm studies! Studies with negative treatment arm variance: '18', '185'
View(DPs)
#check p-value availability for paired t-test
DPs[,c("studlab","tst_PorF-value","tst_p=0, f=1")][DPs$Crossoverstudy==1,]
View(DPs)
#remove crossover studies with paired t-test p-value not available
DPs <- DPs[DPs$`tst_PorF-value`!=NA,]
#check p-value availability for paired t-test
DPs[,c("studlab","tst_PorF-value","tst_p=0, f=1")][DPs$Crossoverstudy==1,]
#get the data and select them
DATA <- read_excel("~/Virginia/NMA insomnia/Insomnia/MyrtoIncludedAllOutcomesClean27.6c.xlsx", na = "NA")
#prepare the data
DATApairs=pairwise(treat=Drug_name,mean=SleepTimeTotalScaleMean,sd=SleepTimeTotalScaleSD,n=SleepTimeTotalScaleParticipants, data=DATA, studlab = Final_ID_all, sm= "SMD")
#run NMA and create an object called EFF for efficacy   ### gives error because consists of 5 separate sub-networks so run netconnection first
netconnection(treat1,treat2,studlab,data=DATApairs,warn = T)
#remove rows for studies disconnected from main network
DPs <- subset(DATApairs, treat2!="waitlist" & treat2!="artificial juice" & treat2!="sleep hygiene" & treat2!="oxazepam")
DPs <- DPs[-grep("LAT",DPs$treat2),]
#check p-value availability for paired t-test
DPs[,c("studlab","tst_PorF-value","tst_p=0, f=1")][DPs$Crossoverstudy==1,]
DPs$`tst_PorF-value`!=NA
DPs$`tst_PorF-value`
DPs[DPs$`tst_PorF-value`!=NA]$studlab
DPs[DPs$`tst_PorF-value`!=NA,]$studlab
DPs[DPs$`tst_PorF-value`==NA,]$studlab
DPs[DPs$`tst_PorF-value`!=NA,]$studlab
DPs[DPs$`tst_PorF-value`!="NA",]$studlab
#remove crossover studies with paired t-test p-value not available
DPs <- DPs[DPs$studlab!=161 | DPs$studlab!=270,]
#check p-value availability for paired t-test
DPs[,c("studlab","tst_PorF-value","tst_p=0, f=1")][DPs$Crossoverstudy==1,]
#remove crossover studies with paired t-test p-value not available
DPs <- DPs[DPs$studlab!=161 & DPs$studlab!=270,]
#check p-value availability for paired t-test
DPs[,c("studlab","tst_PorF-value","tst_p=0, f=1")][DPs$Crossoverstudy==1,]
# use threshold value for those with p-value <0.001
DPs[DPs$studlab==185, "tst_PorF-value"] <- 0.00099
#prepare the data
DATApairs=pairwise(treat=Drug_name,mean=SleepTimeTotalScaleMean,sd=SleepTimeTotalScaleSD,n=SleepTimeTotalScaleParticipants, data=DATA, studlab = Final_ID_all, sm= "SMD")
#run NMA and create an object called EFF for efficacy   ### gives error because consists of 5 separate sub-networks so run netconnection first
netconnection(treat1,treat2,studlab,data=DATApairs,warn = T)
#remove rows for studies disconnected from main network
DPs <- subset(DATApairs, treat2!="waitlist" & treat2!="artificial juice" & treat2!="sleep hygiene" & treat2!="oxazepam")
DPs <- DPs[-grep("LAT",DPs$treat2),]
#check p-value availability for paired t-test
DPs[,c("studlab","tst_PorF-value","tst_p=0, f=1")][DPs$Crossoverstudy==1,]
#remove crossover studies with paired t-test p-value not available
DPs <- DPs[DPs$studlab!=161,]
# use threshold value for those with p-value <0.001
DPs[DPs$studlab==185, "tst_PorF-value"] <- 0.00099
#now calculate adjusted SE for remaining crossover studies
DPs$tvalue <- qt(as.numeric(DPs$`tst_PorF-value`)/2, df=DPs$n1-1, lower.tail = F)
DPs$SDd <- abs((DPs$mean2-DPs$mean1)/DPs$tvalue*sqrt(DPs$n1))
DPs$rho <- (DPs$sd1^2 + DPs$sd2^2 - DPs$SDd^2)/(2*DPs$sd1*DPs$sd2)
DPs[DPs$Crossoverstudy==1,"seTE"] <- sqrt((1/DPs$n1 + DPs$TE/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1]
EFF<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs,  sm="SMD",r="pbo",comb.fixed =F, comb.random = T, tol.multiarm = 0.05, details.chkmultiarm = T)    ### gives error: Problems in multi-arm studies! Studies with negative treatment arm variance: '18', '185'
DATApairs=pairwise(treat=Drug_name,mean=SleepTimeTotalScaleMean,sd=SleepTimeTotalScaleSD,n=SleepTimeTotalScaleParticipants, data=DATA, studlab = Final_ID_all, sm= "SMD")
#run NMA and create an object called EFF for efficacy   ### gives error because consists of 5 separate sub-networks so run netconnection first
netconnection(treat1,treat2,studlab,data=DATApairs,warn = T)
#remove rows for studies disconnected from main network
DPs <- subset(DATApairs, treat2!="waitlist" & treat2!="artificial juice" & treat2!="sleep hygiene" & treat2!="oxazepam")
DPs <- DPs[-grep("LAT",DPs$treat2),]
#check p-value availability for paired t-test
DPs[,c("studlab","tst_PorF-value","tst_p=0, f=1")][DPs$Crossoverstudy==1,]
#check p-value availability for paired t-test
DPs[,c("studlab","tst_PorF-value","tst_p=0, f=1")][DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==0,]
#check p-value availability for paired t-test
DPs[,c("studlab","tst_PorF-value","tst_p=0, f=1")][DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,]
# use threshold value for those with p-value <0.001
DPs[DPs$studlab==185, "tst_PorF-value"] <- 0.00099
#now calculate adjusted SE for remaining crossover studies
DPs$tvalue <- qt(as.numeric(DPs$`tst_PorF-value`)/2, df=DPs$n1-1, lower.tail = F)
DPs$SDd <- abs((DPs$mean2-DPs$mean1)/DPs$tvalue*sqrt(DPs$n1))
DPs$rho <- (DPs$sd1^2 + DPs$sd2^2 - DPs$SDd^2)/(2*DPs$sd1*DPs$sd2)
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("studlab","tst_PorF-value","tst_p=0, f=1")]
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,,c("studlab","tst_PorF-value","tst_p=0, f=1")]
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("studlab","tst_PorF-value","tst_p=0, f=1")]
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"]
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1 + DPs$TE/(2*DPs$n1))*(2-2*DPs$rho))
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1 + DPs$TE/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover]
sqrt((1/DPs$n1+DPs$TE/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1+DPs$TE/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
EFF<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs,  sm="SMD",r="pbo",comb.fixed =F, comb.random = T, tol.multiarm = 0.05, details.chkmultiarm = T)    ### gives error: Problems in multi-arm studies! Studies with negative treatment arm variance: '18', '185'
knitr::opts_chunk$set(echo = TRUE)
library(devtools)
install_github("esm-ispm-unibe-ch/NMAJags")
library(NMAJags)
library(R2jags)
library(netmeta)
library(meta)
library(metafor)
library(readxl)
#get the data and select them
DATA <- read_excel("~/Virginia/NMA insomnia/Insomnia/MyrtoIncludedAllOutcomesClean27.6cVirgi.xlsx", na = "NA")
#get the data and select them
DATA <- read_excel("~/Virginia/NMA insomnia/Insomnia/MyrtoIncludedAllOutcomesClean27.6dVirgi.xlsx", na = "NA")
#prepare the data
DATApairs=pairwise(treat=Drug_name,mean=SleepTimeTotalScaleMean,sd=SleepTimeTotalScaleSD,n=SleepTimeTotalScaleParticipants, data=DATA, studlab = Final_ID_all, sm= "SMD")
#run NMA and create an object called EFF for efficacy   ### gives error because consists of 5 separate sub-networks so run netconnection first
netconnection(treat1,treat2,studlab,data=DATApairs,warn = T)
#remove rows for studies disconnected from main network
DPs <- subset(DATApairs, treat2!="waitlist" & treat2!="artificial juice" & treat2!="sleep hygiene" & treat2!="oxazepam")
DPs <- DPs[-grep("LAT",DPs$treat2),]
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("studlab","tst_PorF-value","tst_p=0, f=1")]
# use threshold value for those with p-value <0.001
DPs[DPs$studlab==185, "tst_PorF-value"] <- 0.00099
#now calculate adjusted SE for remaining crossover studies
DPs$tvalue <- qt(as.numeric(DPs$`tst_PorF-value`)/2, df=DPs$n1-1, lower.tail = F)
DPs$SDd <- abs((DPs$mean2-DPs$mean1)/DPs$tvalue*sqrt(DPs$n1))
DPs$rho <- (DPs$sd1^2 + DPs$sd2^2 - DPs$SDd^2)/(2*DPs$sd1*DPs$sd2)
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1+DPs$TE/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
EFF<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs,  sm="SMD",r="pbo",comb.fixed =F, comb.random = T, tol.multiarm = 0.05, details.chkmultiarm = T)    ### gives error: Problems in multi-arm studies! Studies with negative treatment arm variance: '18', '185'
knitr::opts_chunk$set(echo = TRUE)
library(devtools)
install_github("esm-ispm-unibe-ch/NMAJags")
library(NMAJags)
library(R2jags)
library(netmeta)
library(meta)
library(metafor)
library(readxl)
#get the data and select them
DATA <- read_excel("~/Virginia/NMA insomnia/Insomnia/MyrtoIncludedAllOutcomesClean27.6dVirgiRenamedInterventions.xlsx", na = "NA")
DATAs <- subset(DATA, DATA$SleepQualityScaleParticipants!='NA')
#describe the data
tapply(DATAs$N_arm_total_stapf,DATAs$Drug_name,sum,na.rm=T)
#describe the data
tapply(DATA$N_arm_total_stapf,DATAs$Drug_name,sum,na.rm=T)
#describe the data
tapply(DATA$N_arm_total_stapf,DATAs$Drug_name,sum,na.rm=T)
#describe the data
tapply(DATAs$N_arm_total_stapf,DATAs$Drug_name,sum,na.rm=T)
View(DATA)
print(length(table(DATAs$Drug_name)))
print(length(table(DATAs$Final_ID_all)))
#prepare the data
DATApairs=pairwise(treat=Drug_name,mean=SleepQualityScaleMean,sd=SleepQualityScaleSD,n=SleepQualityScaleParticipants, data=DATA, studlab = Final_ID_all, sm= "SMD")
#run NMA and create an object called EFF for efficacy   ### gives error because consists of 5 separate sub-networks so run netconnection first
netconnection(treat1,treat2,studlab,data=DATApairs,warn = T)
View(DATApairs)
#run NMA and create an object called EFF for efficacy   ### gives error because consists of 5 separate sub-networks so run netconnection first
netconnection(treat1,treat2,studlab,data=DATApairs,warn = T)
options(max.print = 5000)
#run NMA and create an object called EFF for efficacy   ### gives error because consists of 5 separate sub-networks so run netconnection first
netconnection(treat1,treat2,studlab,data=DATApairs,warn = T)
View(DATApairs)
#remove rows for studies disconnected from main network
DPs <- subset(DATApairs, treat2!="waitlist")
DPs <- DPs[-grep("LAT|MAT|acupressure|acupuncture|therapeutic|hygiene|juice",DPs$treat1),]
View(DPs)
DPs <- DPs[-grep("LAT|MAT|acupressure|acupuncture|therapeutic|hygiene|juice|BBT I",DPs$treat1),]
View(DPs)
#prepare the data
DATApairs=pairwise(treat=Drug_name,mean=SleepQualityScaleMean,sd=SleepQualityScaleSD,n=SleepQualityScaleParticipants, data=DATA, studlab = Final_ID_all, sm= "SMD")
View(DATApairs)
#remove rows for studies disconnected from main network
DPs <- subset(DATApairs, treat1!="BBT I" & treat1!="auricular acupuncture")
DPs <- DPs[-grep("LAT|MAT|acupressure|waitlist|therapeutic|hygiene|juice",DPs$treat2),]
View(DPs)
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("studlab","squal_PorF-value","squal_p=0, f=1")]
# use threshold value for those with p-value <0.025
DPs[DPs$studlab==17, "squal_PorF-value"] <- 0.02499
# remove studies for which no p-value available
DPs <- DPs[DPs$studlab!=94 & DPs$studlab!=21,]
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("studlab","squal_PorF-value","squal_p=0, f=1")]
# now calculate adjusted SE for remaining crossover studies
DPs$tvalue <- qt(as.numeric(DPs$`squal_PorF-value`)/2, df=DPs$n1-1, lower.tail = F)
DPs$SDd <- abs((DPs$mean2-DPs$mean1)/DPs$tvalue*sqrt(DPs$n1))
DPs$rho <- (DPs$sd1^2 + DPs$sd2^2 - DPs$SDd^2)/(2*DPs$sd1*DPs$sd2)
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1+DPs$TE/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
# assign other correlation value to study 18 and 185 based on other studies
# DPs[,c("studlab","rho")]
# DPs[DPs$studlab==18|DPs$studlab==185,"rho"] <- 0.9
# DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1+DPs$TE/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
SQ<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs,  sm="SMD",r="pbo",comb.fixed =F, comb.random = T)
netconnection(treat1,treat2,studlab,data=DPs,warn = T)
View(DPs)
DPs <- DPs[DPs$studlab!=13,]
netconnection(treat1,treat2,studlab,data=DPs,warn = T)
knitr::opts_chunk$set(echo = TRUE)
library(devtools)
install_github("esm-ispm-unibe-ch/NMAJags")
library(NMAJags)
library(R2jags)
library(netmeta)
library(meta)
library(metafor)
library(readxl)
#get the data and select them
DATA <- read_excel("~/Virginia/NMA insomnia/Insomnia/MyrtoIncludedAllOutcomesClean27.6dVirgiRenamedInterventions.xlsx", na = "NA")
DATAs <- subset(DATA, DATA$SleepTimeTotalScaleParticipants!='NA')
#prepare the data
DATApairs=pairwise(treat=Drug_name,mean=SleepTimeTotalScaleMean,sd=SleepTimeTotalScaleSD,n=SleepTimeTotalScaleParticipants, data=DATA, studlab = Final_ID_all, sm= "SMD")
#run NMA and create an object called EFF for efficacy   ### gives error because consists of 5 separate sub-networks so run netconnection first
netconnection(treat1,treat2,studlab,data=DATApairs,warn = T)
View(DATApairs)
#remove rows for studies disconnected from main network
DPs <- DPs[-grep("LAT|MAT|BBT I|midazolam|hygiene|juice",DPs$treat1),]
#remove rows for studies disconnected from main network
DPs <- DPs[-grep("LAT|MAT|BBT I|midazolam|hygiene|juice",DATApairs$treat1),]
#remove rows for studies disconnected from main network
DPs <- DATApairs[-grep("LAT|MAT|BBT I|midazolam|hygiene|juice",DATApairs$treat1),]
View(DPs)
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("studlab","tst_PorF-value","tst_p=0, f=1")]
# use threshold value for those with p-value <0.001
DPs[DPs$studlab==185, "tst_PorF-value"] <- 0.00099
#now calculate adjusted SE for remaining crossover studies
DPs$tvalue <- qt(as.numeric(DPs$`tst_PorF-value`)/2, df=DPs$n1-1, lower.tail = F)
DPs$SDd <- abs((DPs$mean2-DPs$mean1)/DPs$tvalue*sqrt(DPs$n1))
DPs$rho <- (DPs$sd1^2 + DPs$sd2^2 - DPs$SDd^2)/(2*DPs$sd1*DPs$sd2)
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1+DPs$TE/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
TST<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs,  sm="SMD",r="pbo",comb.fixed =F, comb.random = T)
# assign other correlation value to study 18 and 185 based on other studies
DPs[,c("studlab","rho")]
DPs[DPs$studlab==18|DPs$studlab==185,"rho"] <- 0.9
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1+DPs$TE/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
TST<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs,  sm="SMD",r="pbo",comb.fixed =F, comb.random = T)
# assign other correlation value to study 18 and 185 based on other studies
DPs[,c("studlab","rho")]
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1+DPs$TE/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
TST<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs,  sm="SMD",r="pbo",comb.fixed =F, comb.random = T)
TST<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs,  sm="SMD",r="pbo",comb.fixed =F, comb.random = T, tol.multiarm = 0.05)
TST
DPs$seTE
knitr::opts_chunk$set(echo = TRUE)
library(devtools)
install_github("esm-ispm-unibe-ch/NMAJags")
library(NMAJags)
library(R2jags)
library(netmeta)
library(meta)
library(metafor)
library(readxl)
#get the data and select them
DATA <- read_excel("~/Virginia/NMA insomnia/Insomnia/MyrtoIncludedAllOutcomesClean27.6dVirgiRenamedInterventions.xlsx", na = "NA")
DATAs <- subset(DATA, DATA$SleepQualityScaleParticipants!='NA')
#prepare the data
DATApairs=pairwise(treat=Drug_name,mean=SleepQualityScaleMean,sd=SleepQualityScaleSD,n=SleepQualityScaleParticipants, data=DATA, studlab = Final_ID_all, sm= "SMD")
#run NMA and create an object called EFF for efficacy   ### gives error because consists of 5 separate sub-networks so run netconnection first
netconnection(treat1,treat2,studlab,data=DATApairs,warn = T)
options(max.print = 5000)
#run NMA and create an object called EFF for efficacy   ### gives error because consists of 5 separate sub-networks so run netconnection first
netconnection(treat1,treat2,studlab,data=DATApairs,warn = T)
#remove rows for studies disconnected from main network
DPs <- subset(DATApairs, treat1!="BBT I" & treat1!="auricular acupuncture")
DPs <- DPs[-grep("LAT|MAT|acupressure|waitlist|therapeutic|hygiene|juice",DPs$treat2),]
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("studlab","squal_PorF-value","squal_p=0, f=1")]
# use threshold value for those with p-value <0.025
DPs[DPs$studlab==17, "squal_PorF-value"] <- 0.02499
# remove studies for which no p-value available
DPs <- DPs[DPs$studlab!=94 & DPs$studlab!=21,]
# now calculate adjusted SE for remaining crossover studies
DPs$tvalue <- qt(as.numeric(DPs$`squal_PorF-value`)/2, df=DPs$n1-1, lower.tail = F)
DPs$SDd <- abs((DPs$mean2-DPs$mean1)/DPs$tvalue*sqrt(DPs$n1))
DPs$rho <- (DPs$sd1^2 + DPs$sd2^2 - DPs$SDd^2)/(2*DPs$sd1*DPs$sd2)
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1+DPs$TE/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
# assign other correlation value to study 18 and 185 based on other studies
# DPs[,c("studlab","rho")]
# DPs[DPs$studlab==18|DPs$studlab==185,"rho"] <- 0.9
# DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1+DPs$TE/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
SQ<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs,  sm="SMD",r="pbo",comb.fixed =F, comb.random = T)
View(DATApairs)
View(DPs)
View(DATApairs)
knitr::opts_chunk$set(echo = TRUE)
library(devtools)
install_github("esm-ispm-unibe-ch/NMAJags")
library(NMAJags)
library(R2jags)
library(netmeta)
library(meta)
library(metafor)
library(readxl)
#get the data and select them
DATA <- read_excel("~/Virginia/NMA insomnia/Insomnia/MyrtoIncludedAllOutcomesClean27.6dVirgiRenamedInterventions.xlsx", na = "NA")
#get the data and select them
DATA <- read_excel("~/Virginia/NMA insomnia/Insomnia/MyrtoIncludedAllOutcomesClean27.6dVirgiRenamedInterventions.xlsx", na = "NA")
DATAs <- subset(DATA, DATA$SleepTimeTotalScaleParticipants!='NA')
#prepare the data
DATApairs=pairwise(treat=Drug_name,mean=SleepTimeTotalScaleMean,sd=SleepTimeTotalScaleSD,n=SleepTimeTotalScaleParticipants, data=DATA, studlab = Final_ID_all, sm= "SMD")
#run NMA and create an object called EFF for efficacy   ### gives error because consists of 5 separate sub-networks so run netconnection first
netconnection(treat1,treat2,studlab,data=DATApairs,warn = T)
#remove rows for studies disconnected from main network
DPs <- DATApairs[-grep("LAT|MAT|BBT I|midazolam|hygiene|juice",DATApairs$treat1),]
View(DATApairs)
View(DPs)
View(DATAs)
View(DPs)
View(DATApairs)
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("studlab","tst_PorF-value","tst_p=0, f=1")]
# use threshold value for those with p-value <0.001
DPs[DPs$studlab==185, "tst_PorF-value"] <- 0.00099
#now calculate adjusted SE for remaining crossover studies
DPs$tvalue <- qt(as.numeric(DPs$`tst_PorF-value`)/2, df=DPs$n1-1, lower.tail = F)
DPs$SDd <- abs((DPs$mean2-DPs$mean1)/DPs$tvalue*sqrt(DPs$n1))
DPs$rho <- (DPs$sd1^2 + DPs$sd2^2 - DPs$SDd^2)/(2*DPs$sd1*DPs$sd2)
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1+DPs$TE/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
TST<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs,  sm="SMD",r="pbo",comb.fixed =F, comb.random = T, tol.multiarm = 0.05)
# assign other correlation value to study 18 and 185 based on other studies
DPs[,c("studlab","rho")]
DPs[DPs$studlab==18|DPs$studlab==185,"rho"] <- 0.9
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1+DPs$TE/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
TST<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs,  sm="SMD",r="pbo",comb.fixed =F, comb.random = T, tol.multiarm = 0.05)
TST<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs,  sm="SMD",r="pbo",comb.fixed =F, comb.random = T)
TST<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs,  sm="SMD",r="pbo",comb.fixed =F, comb.random = T, details.chkmultiarm=TRUE)
View(DPs)
TST<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs,  sm="SMD",r="pbo",comb.fixed =F, comb.random = T, tol.multiarm = 0.1)
#network plot
netgraph(TST, plastic=F, thickness="number.of.studies", multiarm = F, points=T, col=1)
View(DPs)
#prepare the data
DATApairs=pairwise(treat=Drug_name,mean=SleepTimeTotalScaleMean,sd=SleepTimeTotalScaleSD,n=SleepTimeTotalScaleParticipants, data=DATA, studlab = Final_ID_all, sm= "SMD")
#remove rows for studies disconnected from main network
DPs <- DATApairs[-grep("LAT|MAT|BBT I|midazolam|hygiene|juice",DATApairs$treat1),]
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("studlab","tst_PorF-value","tst_p=0, f=1")]
# use threshold value for those with p-value <0.001
DPs[DPs$studlab==185, "tst_PorF-value"] <- 0.00099
#now calculate adjusted SE for remaining crossover studies
DPs$tvalue <- qt(as.numeric(DPs$`tst_PorF-value`)/2, df=DPs$n1-1, lower.tail = F)
DPs$SDd <- abs((DPs$mean2-DPs$mean1)/DPs$tvalue*sqrt(DPs$n1))
DPs$rho <- (DPs$sd1^2 + DPs$sd2^2 - DPs$SDd^2)/(2*DPs$sd1*DPs$sd2)
# assign other correlation value to study 18 and 185 based on other studies
DPs[,c("studlab","rho")]
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1+DPs$TE/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"]
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("studlab","seTE")]
DPs[DPs$studlab==18|DPs$studlab==185,"rho"] <- 0.9
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1+DPs$TE/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("studlab","seTE")]
#prepare the data
DATApairs=pairwise(treat=Drug_name,mean=SleepTimeTotalScaleMean,sd=SleepTimeTotalScaleSD,n=SleepTimeTotalScaleParticipants, data=DATA, studlab = Final_ID_all, sm= "SMD")
#remove rows for studies disconnected from main network
DPs <- DATApairs[-grep("LAT|MAT|BBT I|midazolam|hygiene|juice",DATApairs$treat1),]
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("studlab","tst_PorF-value","tst_p=0, f=1")]
# use threshold value for those with p-value <0.001
DPs[DPs$studlab==185, "tst_PorF-value"] <- 0.00099
#now calculate adjusted SE for remaining crossover studies
DPs$tvalue <- qt(as.numeric(DPs$`tst_PorF-value`)/2, df=DPs$n1-1, lower.tail = F)
DPs$SDd <- abs((DPs$mean2-DPs$mean1)/DPs$tvalue*sqrt(DPs$n1))
DPs$rho <- (DPs$sd1^2 + DPs$sd2^2 - DPs$SDd^2)/(2*DPs$sd1*DPs$sd2)
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1+(DPs$TE^2)/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
TST<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs,  sm="SMD",r="pbo",comb.fixed =F, comb.random = T, tol.multiarm = 0.05)
DPs[DPs$studlab==18|DPs$studlab==185,"rho"] <- 0.9
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1+(DPs$TE^2)/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1+(DPs$TE^2)/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
TST<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs,  sm="SMD",r="pbo",comb.fixed =F, comb.random = T, tol.multiarm = 0.05)
TST
#network plot
netgraph(TST, plastic=F, thickness="number.of.studies", multiarm = F, points=T, col=1)
#forest plots
forest(TST, ref="pbo", sortvar = -Pscore,xlab="SMD")
TST$n.trts
TST$n
TST$trts
TST$k
TST$n1+TST$n2
TST$n1
netrank(TST, small.values = "bad")
cat(paste("tau=",round(TST$tau,3)))
cat(paste("I2=",round(TST$I2),"%"))
split=netsplit(TST)
SIDEp=split$compare.random$p
SIDEp=SIDEp[!is.na(SIDEp)]
#proportion of inconsistent loops
cat(length(SIDEp))
cat(length(SIDEp[SIDEp<=0.1]))
a=decomp.design(EFF)
a=decomp.design(TST)
print(round(a$Q.inc.random$pval,3))
#only non-crossover
InsoTSTsen=subset(DPs,Crossoverstudy!=1 &`crossover, not first phase used`!=1)  ### can I just take a subset of the previous pairwise dataset? or do I need to do a subset of the original dataset and then do the pairwise again?
TSTsens<-netmeta(TE,seTE,treat1,treat2,studlab,data=InsoTSTsen,  sm="SMD",comb.fixed =F, comb.random = T)
TSTsens<-netmeta(TE,seTE,treat1,treat2,studlab,data=InsoTSTsen,  sm="SMD",comb.fixed =F, comb.random = T)
TSTsens
forest(TSTsens, ref="pbo",sortvar = -Pscore, smlab="Only head-to-head studies", fontsize=10)
forest(TSTsens, ref="pbo",sortvar = -Pscore, smlab="Only parallel studies", fontsize=10)
forest(TSTsens, ref="pbo",sortvar = -Pscore, smlab="Only parallel studies", fontsize=10)
library(devtools)
install_github("esm-ispm-unibe-ch/NMAJags")
library(NMAJags)
library(R2jags)
library(netmeta)
library(meta)
library(metafor)
library(readxl)
#get the data and select them
DATA <- read_excel("~/Virginia/NMA insomnia/Insomnia/MyrtoIncludedAllOutcomesClean27.6dVirgiRenamedInterventions.xlsx", na = "NA")
#get the data and select them
DATA <- read_excel("~/Virginia/NMA insomnia/Insomnia/MyrtoIncludedAllOutcomesClean27.6dVirgiRenamedInterventions.xlsx", na = "NA")
#prepare the data
DATApairs=pairwise(treat=Drug_name,mean=SleepQualityScaleMean,sd=SleepQualityScaleSD,n=SleepQualityScaleParticipants, data=DATA, studlab = Final_ID_all, sm= "SMD")
#run NMA and create an object called EFF for efficacy   ### gives error because consists of 5 separate sub-networks so run netconnection first
netconnection(treat1,treat2,studlab,data=DATApairs,warn = T)
#remove rows for studies disconnected from main network
DPs <- subset(DATApairs, treat1!="BBT I" & treat1!="auricular acupuncture")
DPs <- DPs[-grep("LAT|MAT|acupressure|waitlist|therapeutic|hygiene|juice",DPs$treat2),]
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("studlab","squal_PorF-value","squal_p=0, f=1")]
# use threshold value for those with p-value <0.025
DPs[DPs$studlab==17, "squal_PorF-value"] <- 0.02499
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("studlab","squal_PorF-value","squal_p=0, f=1")]
# remove studies for which no p-value available
DPs <- DPs[DPs$studlab!=94 & DPs$studlab!=21,]
# now calculate adjusted SE for remaining crossover studies
DPs$tvalue <- qt(as.numeric(DPs$`squal_PorF-value`)/2, df=DPs$n1-1, lower.tail = F)
DPs$SDd <- abs((DPs$mean2-DPs$mean1)/DPs$tvalue*sqrt(DPs$n1))
DPs$rho <- (DPs$sd1^2 + DPs$sd2^2 - DPs$SDd^2)/(2*DPs$sd1*DPs$sd2)
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1+(DPs$TE^2)/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
# assign other correlation value to study 18 and 185 based on other studies
# DPs[,c("studlab","rho")]
# DPs[DPs$studlab==18|DPs$studlab==185,"rho"] <- 0.9
# DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1+DPs$TE/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
SQ<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs,  sm="SMD",r="pbo",comb.fixed =F, comb.random = T)
View(DPs)
# assign other correlation value to study 18 and 185 based on other studies
# DPs[,c("studlab","rho")]
# DPs[DPs$studlab==18|DPs$studlab==185,"rho"] <- 0.9
# DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1+DPs$TE/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
SQ<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs, subset = DPs[-grep("chlormethiazole|triazolam|zopiclone|loprazolam|nitrazepam",DPs$treat1),]  sm="SMD",r="pbo",comb.fixed =F, comb.random = T)
# assign other correlation value to study 18 and 185 based on other studies
# DPs[,c("studlab","rho")]
# DPs[DPs$studlab==18|DPs$studlab==185,"rho"] <- 0.9
# DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1+DPs$TE/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
SQ<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs, subset = DPs[-grep("chlormethiazole|triazolam|zopiclone|loprazolam|nitrazepam",DPs$treat1),], sm="SMD",r="pbo",comb.fixed =F, comb.random = T)
# assign other correlation value to study 18 and 185 based on other studies
# DPs[,c("studlab","rho")]
# DPs[DPs$studlab==18|DPs$studlab==185,"rho"] <- 0.9
# DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1+DPs$TE/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
SQ<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs, subset = seq(1,10), sm="SMD",r="pbo",comb.fixed =F, comb.random = T)
# assign other correlation value to study 18 and 185 based on other studies
# DPs[,c("studlab","rho")]
# DPs[DPs$studlab==18|DPs$studlab==185,"rho"] <- 0.9
# DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1+DPs$TE/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
SQ<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs, subset = c(1,3,5,7,9,11,15), sm="SMD",r="pbo",comb.fixed =F, comb.random = T)
# assign other correlation value to study 18 and 185 based on other studies
# DPs[,c("studlab","rho")]
# DPs[DPs$studlab==18|DPs$studlab==185,"rho"] <- 0.9
# DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1+DPs$TE/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
SQ<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs, subset = c(2,12,15,16), sm="SMD",r="pbo",comb.fixed =F, comb.random = T)
# assign other correlation value to study 18 and 185 based on other studies
# DPs[,c("studlab","rho")]
# DPs[DPs$studlab==18|DPs$studlab==185,"rho"] <- 0.9
# DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1+DPs$TE/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
SQ<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs, subset = -c(2,12,15,16), sm="SMD",r="pbo",comb.fixed =F, comb.random = T)
# assign other correlation value to study 18 and 185 based on other studies
# DPs[,c("studlab","rho")]
# DPs[DPs$studlab==18|DPs$studlab==185,"rho"] <- 0.9
# DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1+DPs$TE/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
SQ<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs, subset = c(2,12,15,16), sm="SMD",r="nitrazepam",comb.fixed =F, comb.random = T)
SQ
grep("chlormethiazole|triazolam|zopiclone|loprazolam|nitrazepam",DPs$treat1)
grep("chlormethiazole|triazolam|zopiclone|loprazolam|nitrazepam",DPs$treat1, value = T)
grep("chlormethiazole|triazolam|zopiclone|loprazolam|nitrazepam",DPs$treat1, fixed = T)
grep(paste(chlormethiazole,triazolam,zopiclone,loprazolam,nitrazepam,collapse = |),DPs$treat1)
grep(paste("chlormethiazole","triazolam","zopiclone","loprazolam","nitrazepam",collapse = |),DPs$treat1)
paste("chlormethiazole","triazolam","zopiclone","loprazolam","nitrazepam",collapse = |)
grep(paste(chlormethiazole,triazolam,zopiclone,loprazolam,nitrazepam,collapse = "|"),DPs$treat1)
paste(chlormethiazole,triazolam,zopiclone,loprazolam,nitrazepam,collapse = "|")
paste("chlormethiazole","triazolam","zopiclone","loprazolam","nitrazepam",collapse = "|")
grep(paste("chlormethiazole","triazolam","zopiclone","loprazolam","nitrazepam",collapse = "|"),DPs$treat1)
excl <- c("chlormethiazole","triazolam","zopiclone","loprazolam","nitrazepam")
paste(excl,collapse = "|")
grep(paste(paste(excl,collapse = "|"),DPs$treat1)
grep(paste(paste(excl,collapse = "|"),DPs$treat1))
grep((paste(excl,collapse = "|"),DPs$treat1))
grep(paste(excl,collapse = "|"),DPs$treat1)
grep(paste(excl,collapse = "|"),DPs$treat1, fixed = T)
grep("chlormethiazole|triazolam|loprazolam|nitrazepam",DPs$treat1)
-grep("chlormethiazole|triazolam|loprazolam|nitrazepam",DPs$treat1)
# assign other correlation value to study 18 and 185 based on other studies
# DPs[,c("studlab","rho")]
# DPs[DPs$studlab==18|DPs$studlab==185,"rho"] <- 0.9
# DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1+DPs$TE/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
SQ<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs, sm="SMD",r="nitrazepam",comb.fixed =F, comb.random = T)
SQ1<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs, subset = -grep("chlormethiazole|triazolam|loprazolam|nitrazepam",DPs$treat1) sm="SMD",r="nitrazepam",comb.fixed =F, comb.random = T)
SQ1<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs, subset = c(-grep("chlormethiazole|triazolam|loprazolam|nitrazepam",DPs$treat1)) sm="SMD",r="nitrazepam",comb.fixed =F, comb.random = T)
SQ1<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs, subset = c(-2, -12, -15, -16) sm="SMD",r="nitrazepam",comb.fixed =F, comb.random = T)
c(grep("chlormethiazole|triazolam|loprazolam|nitrazepam",DPs$treat1))
-c(grep("chlormethiazole|triazolam|loprazolam|nitrazepam",DPs$treat1))
SQ1<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs, subset = -c(grep("chlormethiazole|triazolam|loprazolam|nitrazepam",DPs$treat1)) sm="SMD",r="nitrazepam",comb.fixed =F, comb.random = T)
SQ1<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs, subset = -grep("chlormethiazole|triazolam|loprazolam|nitrazepam",DPs$treat1), sm="SMD",r="nitrazepam",comb.fixed =F, comb.random = T)
SQ1<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs, subset = -grep("chlormethiazole|triazolam|loprazolam|nitrazepam",DPs$treat1), sm="SMD",r="pbo",comb.fixed =F, comb.random = T)
netmeta
SQ2 <- netmeta(TE,seTE,treat1,treat2,studlab,data=DPs, subset = grep("chlormethiazole|triazolam|loprazolam|nitrazepam",DPs$treat1), sm="SMD",r="pbo",comb.fixed =F, comb.random = T)
SQ2 <- netmeta(TE,seTE,treat1,treat2,studlab,data=DPs, subset = grep("chlormethiazole|triazolam|loprazolam|nitrazepam",DPs$treat1), sm="SMD",r="nitrazepam",comb.fixed =F, comb.random = T)
SQ2
SQ2 <- netmeta(TE,seTE,treat1,treat2,studlab,data=DPs, subset = grep("chlormethiazole|triazolam|loprazolam|nitrazepam",DPs$treat1), sm="SMD",r="chlormethiazole",comb.fixed =F, comb.random = T)
SQ2
SQ1<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs, subset = -grep("chlormethiazole|triazolam|loprazolam|nitrazepam",DPs$treat1), sm="SMD",r="pbo",comb.fixed =F, comb.random = T)
View(subset(-grep("chlormethiazole|triazolam|loprazolam|nitrazepam",DPs$treat1)))
SQ1<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs, subset = c(-grep("chlormethiazole|triazolam|loprazolam|nitrazepam",DPs$treat1)), sm="SMD",r="pbo",comb.fixed =F, comb.random = T)
